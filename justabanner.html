<html>
  <head>
    <script
      async
      src="https://www.googletagservices.com/tag/js/gpt.js"
    ></script>
    <script src="static/js/prebid.js"></script>
    <script>
      var PREBID_TIMEOUT = 1000;
      var FAILSAFE_TIMEOUT = 3000;

      // Ad units
      var adUnits = [
        {
          code: "/19968336/header-bid-tag-0",
          mediaTypes: {
            banner: {
              sizes: [[300, 250], [300, 50]],
            },
          },
          bids: [
            {
              bidder: "chx",
              params: {
                placementId: 1234567890,
                publisher: "JustABanner",
                domain: "justabanner.com",
              },
            },
          ],
        },
      ];

      // (the following was taken from prebid.org)
      // ======== DO NOT EDIT BELOW THIS LINE =========== //
      var googletag = googletag || {};
      googletag.cmd = googletag.cmd || [];
      googletag.cmd.push(function () {
        googletag.pubads().disableInitialLoad();
      });

      var pbjs = pbjs || {};
      pbjs.que = pbjs.que || [];

      pbjs.que.push(function () {
        pbjs.addAdUnits(adUnits);
        pbjs.requestBids({
          bidsBackHandler: initAdserver,
          timeout: PREBID_TIMEOUT,
        });
      });

      function initAdserver() {
        if (pbjs.initAdserverSet) return;
        pbjs.initAdserverSet = true;
        googletag.cmd.push(function () {
          pbjs.que.push(function () {
            pbjs.setTargetingForGPTAsync();
            googletag.pubads().refresh();
          });
        });
      }

      setTimeout(function () {
        initAdserver();
      }, FAILSAFE_TIMEOUT);

      adUnits.map((ad) => {
        googletag.cmd.push(function () {
          googletag
            .defineSlot(ad.code, ad.mediaTypes.banner.sizes, "banner")
            .addService(googletag.pubads());
          googletag.pubads().enableSingleRequest();
          googletag.enableServices();
        });
      });
    </script>
    <style>
      html,
      body,
      * {
        margin: 0;
        padding: 0;
      }

      #page {
        display: grid;
        justify-content: center;
        align-content: center;
        height: 100%;
        background: #e4a;
      }

      #banner {
        display: grid;
        justify-content: center;
        align-content: center;
        border: 4px solid black;
      }

      #to-yes,
      #to-no,
      #bw-yes,
      #bw-no {
        display: none;
      }
    </style>
  </head>

  <body>
    <div id="page">
      <div id="banner">
        <script type="text/javascript">
          googletag.cmd.push(function () {
            googletag.display("banner");
          });
        </script>
        <p>Loading...</p>
      </div>
      <div>
        <p>Timeout? <span id="to-yes">Yes!</span><span id="to-no">No!</span></p>
        <p>Bid won? <span id="bw-yes">Yes!</span><span id="bw-no">No!</span></p>
      </div>
    </div>
  </body>
</html>
